{"messages": [{"role": "user", "content": "今年签约金额是多少"}, {"role": "assistant", "content": "我来帮您查询今年的签约金额。以下是查询SQL：\n```sql\nSELECT SUM(`SIGNED_AMOUNT`) AS \"今年签约金额（元）\"\nFROM `contracts`\nWHERE YEAR(`fdate`) = YEAR(CURDATE());\n```"}]}
{"messages": [{"role": "user", "content": "DG公司本月签约金额是多少"}, {"role": "assistant", "content": "我来帮您查询DG公司本月的签约金额。以下是查询SQL：\n```sql\nSELECT SUM(`SIGNED_AMOUNT`) AS \"本月签约金额（元）\"\nFROM `contracts`\nWHERE `COMPANY_NAME` = 'DG公司' AND YEAR(`fdate`) = YEAR(CURDATE()) AND MONTH(`fdate`) = MONTH(CURDATE());\n```"}]}
{"messages": [{"role": "user", "content": "上个月签约金额多少"}, {"role": "assistant", "content": "我来帮您查询上个月的签约金额。以下是查询SQL：\n```sql\nSELECT SUM(`SIGNED_AMOUNT`) AS \"上月签约金额（元）\"\nFROM `contracts`\nWHERE YEAR(`fdate`) = YEAR(CURDATE() - INTERVAL 1 MONTH) \n  AND MONTH(`fdate`) = MONTH(CURDATE() - INTERVAL 1 MONTH);\n```"}]}
{"messages": [{"role": "user", "content": "今年2月同比去年签约金额增长了吗"}, {"role": "assistant", "content": "我来帮您比较今年2月和去年2月的签约金额。以下是查询SQL：\n```sql\nwith current_year_sales as (\n  select \n    sum(`SIGNED_AMOUNT`) as \"current_year_amount\"\n  from \n    `CONTRACTS` a \n  where \n    YEAR(a.`fdate`) = YEAR(CURDATE()) AND MONTH(a.`fdate`) =2\n),\nlast_year_sales as (\n  select \n    sum(`SIGNED_AMOUNT`) as \"last_year_amount\"\n  from \n    `CONTRACTS` a \n  where \n    YEAR(a.`fdate`) = YEAR(CURDATE())-1 AND MONTH(a.`fdate`) =2\n)\nselect \n  cys.`current_year_amount` as \"今年2月签约金额\",\n  lys.`last_year_amount` as \"去年2月签约金额\",\n  if(cys.`current_year_amount` > lys.`last_year_amount`, '增长', '未增长') as \"是否增长\",\n  (cys.`current_year_amount` - lys.`last_year_amount`) as \"增长金额\"\nfrom \n  current_year_sales cys,\n  last_year_sales lys;\n```"}]}
{"messages": [{"role": "user", "content": "去年有多少家公司签约金额超过1000万元"}, {"role": "assistant", "content": "我来帮您查询去年签约金额超过1000万元的公司，需要将1000万转成10000000。以下是查询SQL：\n```sql\nSELECT \n    c.`COMPANY_NAME`,\n    SUM(c.`SIGNED_AMOUNT`) AS \"总签约金额（元）\"\nFROM \n    `contracts` c\nWHERE \n    YEAR(c.`fdate`) = YEAR(CURDATE()) - 1\nGROUP BY \n    c.`COMPANY_NAME`\nHAVING \n    SUM(c.`SIGNED_AMOUNT`) > 10000000\nORDER BY \n    SUM(c.`SIGNED_AMOUNT`) DESC;\n```"}]}
{"messages": [{"role": "user", "content": "本月卖了多少套房子"}, {"role": "assistant", "content": "我来帮您查询本月的房屋销售套数。以下是查询SQL：\n```sql\nSELECT \n    SUM(`SIGNED_SETS`) AS \"本月签约总套数\"  \nFROM \n    `contracts`  \nWHERE \n    MONTH(`fdate`) = MONTH(CURRENT_DATE)  \n    AND YEAR(`fdate`) = YEAR(CURRENT_DATE);\n```"}]}
{"messages": [{"role": "user", "content": "前年有多少家公司连续3个月签约金额下滑"}, {"role": "assistant", "content": "我来帮您查询前年连续3个月签约金额下滑的公司。以下是查询SQL：\n```sql\nWITH monthly_data AS (\n    SELECT \n        `COMPANY_NAME` AS company,\n        DATE_FORMAT(`fdate`, '%Y-%m') AS month,\n        SUM(`SIGNED_AMOUNT`) AS monthly_signed_amount\n    FROM `contracts`\n    WHERE YEAR(`fdate`) = YEAR(CURRENT_DATE)-2\n    GROUP BY `COMPANY_NAME`, DATE_FORMAT(`fdate`, '%Y-%m')\n),\ntrend_data AS (\n    SELECT\n        company,\n        month,\n        monthly_signed_amount,\n        LAG(monthly_signed_amount, 1) OVER (PARTITION BY company ORDER BY month) AS prev_month_amount,\n        LAG(monthly_signed_amount, 2) OVER (PARTITION BY company ORDER BY month) AS prev_prev_month_amount\n    FROM monthly_data\n)\nSELECT \n    company,\n    monthly_signed_amount,\n    prev_month_amount,\n    prev_prev_month_amount\nFROM trend_data\nWHERE monthly_signed_amount < prev_month_amount\n  AND prev_month_amount < prev_prev_month_amount\n  AND prev_month_amount IS NOT NULL\n  AND prev_prev_month_amount IS NOT NULL;\n```"}]}
{"messages": [{"role": "user", "content": "去年套均价多少"}, {"role": "assistant", "content": "我来帮您查询去年的房屋套均价。以下是查询SQL：\n```sql\nSELECT \n    SUM(`SIGNED_AMOUNT`) / SUM(`SIGNED_SETS`) AS \"去年套均价（元）\"\nFROM \n    `contracts`\nWHERE \n    YEAR(`fdate`) = YEAR(CURDATE()) - 1;\n```"}]} 