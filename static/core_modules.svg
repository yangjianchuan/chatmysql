<svg xmlns="http://www.w3.org/2000/svg" width="900" height="700" viewBox="0 0 900 700">
  <!-- 定义样式 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <linearGradient id="moduleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#4a6fa5" />
      <stop offset="100%" stop-color="#2a4d7f" />
    </linearGradient>
    <linearGradient id="userGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#6a9c78" />
      <stop offset="100%" stop-color="#4a7c58" />
    </linearGradient>
    <linearGradient id="dataGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#d17b46" />
      <stop offset="100%" stop-color="#b15b26" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3" />
    </filter>
  </defs>
  
  <!-- 背景 -->
  <rect width="900" height="700" fill="#f8f9fa" />
  
  <!-- 标题 -->
  <text x="450" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">ChatMySQL 核心功能模块</text>
  
  <!-- 用户交互模块 -->
  <rect x="400" y="70" width="120" height="60" rx="10" ry="10" fill="url(#userGradient)" filter="url(#shadow)" />
  <text x="460" y="105" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">用户查询</text>
  
  <!-- Flask Web服务模块 -->
  <rect x="400" y="170" width="120" height="60" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="460" y="195" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Flask Web服务</text>
  <text x="460" y="215" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">处理HTTP请求</text>
  
  <!-- SQL生成模块 -->
  <rect x="200" y="280" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="270" y="305" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">SQL生成模块</text>
  <text x="270" y="325" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">OpenAI API调用</text>
  <text x="270" y="340" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">自然语言转SQL</text>
  
  <!-- SQL执行模块 -->
  <rect x="400" y="280" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="470" y="305" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">SQL执行模块</text>
  <text x="470" y="325" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">SQL查询清理</text>
  <text x="470" y="340" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">执行查询并获取结果</text>
  
  <!-- 结果处理模块 -->
  <rect x="600" y="280" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="670" y="305" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">结果处理模块</text>
  <text x="670" y="325" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">数据格式化</text>
  <text x="670" y="340" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">JSON序列化</text>
  
  <!-- 数据库连接模块 -->
  <rect x="400" y="400" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="470" y="425" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">数据库连接模块</text>
  <text x="470" y="445" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">MySQL连接管理</text>
  <text x="470" y="460" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">环境变量配置</text>
  
  <!-- 图表推荐模块 -->
  <rect x="600" y="400" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="670" y="425" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">图表推荐模块</text>
  <text x="670" y="445" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">数据类型分析</text>
  <text x="670" y="460" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">ECharts配置生成</text>
  
  <!-- 结果摘要模块 -->
  <rect x="200" y="400" width="140" height="70" rx="10" ry="10" fill="url(#moduleGradient)" filter="url(#shadow)" />
  <text x="270" y="425" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">结果摘要模块</text>
  <text x="270" y="445" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">OpenAI API调用</text>
  <text x="270" y="460" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="white">生成查询结果摘要</text>
  
  <!-- 数据库 -->
  <rect x="400" y="520" width="140" height="60" rx="10" ry="10" fill="url(#dataGradient)" filter="url(#shadow)" />
  <text x="470" y="555" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">MySQL数据库</text>
  
  <!-- 用户响应 -->
  <rect x="400" y="620" width="140" height="60" rx="10" ry="10" fill="url(#userGradient)" filter="url(#shadow)" />
  <text x="470" y="655" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">用户响应</text>
  
  <!-- 连接线 -->
  <!-- 用户查询到Flask -->
  <line x1="460" y1="130" x2="460" y2="170" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- Flask到SQL生成 -->
  <path d="M400 200 H270 V280" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- Flask到SQL执行 -->
  <line x1="460" y1="230" x2="460" y2="280" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- Flask到结果处理 -->
  <path d="M520 200 H670 V280" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- SQL生成到SQL执行 -->
  <line x1="340" y1="315" x2="400" y2="315" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- SQL执行到结果处理 -->
  <line x1="540" y1="315" x2="600" y2="315" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- SQL执行到数据库连接 -->
  <line x1="470" y1="350" x2="470" y2="400" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- 数据库连接到数据库 -->
  <line x1="470" y1="470" x2="470" y2="520" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- 结果处理到图表推荐 -->
  <line x1="670" y1="350" x2="670" y2="400" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <!-- 结果处理到结果摘要 -->
  <path d="M600 315 H270 V400" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- 图表推荐、结果摘要到用户响应 -->
  <path d="M600 435 H550 V620 H540" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M340 435 H390 V620 H400" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  
  <!-- 用户响应到用户查询（循环） -->
  <path d="M470 620 V600 H100 V100 H400" stroke="#333" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
  
  <!-- 图例 -->
  <rect x="730" y="620" width="20" height="20" fill="url(#userGradient)" />
  <text x="755" y="635" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#333">用户交互</text>
  
  <rect x="730" y="650" width="20" height="20" fill="url(#moduleGradient)" />
  <text x="755" y="665" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#333">处理模块</text>
  
  <rect x="730" y="680" width="20" height="20" fill="url(#dataGradient)" />
  <text x="755" y="695" font-family="Arial, sans-serif" font-size="12" text-anchor="start" fill="#333">数据存储</text>
</svg>